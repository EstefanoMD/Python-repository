from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.options import Options 
import openpyxl
import time

# Carregue a planilha
arquivo_planilha = openpyxl.load_workbook(r'C:\Users\estef\Documents\Python\Projeto_quality_automatizacao\Planilha teste.xlsx')

# Selecione a planilha
planilha = arquivo_planilha['Planilha']

# Obtenha os dados da planilha

nota_fiscal = []
for valor in planilha.iter_rows(min_row=3, min_col=12, values_only=True):
    inteiro = int(valor[0])
    nota_fiscal.append(inteiro)


data = []
for valor in planilha.iter_rows(min_row=3, min_col=5, values_only=True):
    string = str(valor[0])
    data.append(string)


rota_origem = []
for valor in planilha.iter_rows(min_row=3, min_col=7, values_only=True):
    rota_origem.append(valor[0])


rota_destino = []
for valor in planilha.iter_rows(min_row=3, min_col=8, values_only=True):
    rota_destino.append(valor[0])


cpf = []
for valor in planilha.iter_rows(min_row=3, min_col=17, values_only=True):
    string = str(valor[0])
    cpf.append(string)


options = Options()
options.add_experimental_option("detach", True)
nav = webdriver.Chrome(r'C:\Users\estef\Documents\WebDrivers\chromedriver_win32\chromedriver', options=options)    
nav.get('https://docs.google.com/forms/d/e/1FAIpQLSduUoUhCBzuMXoA8XmLTAjWZ5KUQW5j5sgGYzVwLUIbQhi_kA/viewform?vc=0&c=0&w=1&flr=0')
for nf , dt, ro, rd, cpf in zip(nota_fiscal, data , rota_origem, rota_destino,cpf):
    time.sleep(2)

    # Preencha cada campo do formulÃ¡rio com os dados da planilha
    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(1) > div > div > div.AgroKb > div > div.aCsJod.oJeWuf > div > div.Xb9hP > input').send_keys(str(nf))
    
    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(2) > div > div > div.AgroKb > div > div.aCsJod.oJeWuf > div > div.Xb9hP > input').send_keys(str(dt))
    
    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(3) > div > div > div.vQES8d > div > div:nth-child(1) > div.ry3kXd > div.MocG8c.HZ3kWc.mhLiyf.LMgvRb.KKjvXb.DEh1R').click()
    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(3) > div > div > div.vQES8d > div > div:nth-child(1) > div.ry3kXd > div.MocG8c.HZ3kWc.mhLiyf.LMgvRb.KKjvXb.DEh1R').send_keys(ro)
    elemento = nav.find_element(By.CSS_SELECTOR, "#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(3) > div > div > div.vQES8d > div > div:nth-child(1) > div.ry3kXd > div.MocG8c.HZ3kWc.mhLiyf.OIC90c.LMgvRb.KKjvXb").send_keys(Keys.ENTER)

    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(5) > div > div > div.vQES8d > div > div:nth-child(1) > div.ry3kXd > div.MocG8c.HZ3kWc.mhLiyf.LMgvRb.DEh1R.KKjvXb').click()
    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(5) > div > div > div.vQES8d > div > div:nth-child(1) > div.ry3kXd > div.MocG8c.HZ3kWc.mhLiyf.LMgvRb.DEh1R.KKjvXb').send_keys(rd)
    # elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(5) > div > div > div.vQES8d > div > div:nth-child(1) > div.ry3kXd > div.MocG8c.HZ3kWc.mhLiyf.LMgvRb.DEh1R.KKjvXb').send_keys(Keys.ENTER)
    
    #Para reembalagem tipo sacararia 
    elemento = nav.find_element(By.CSS_SELECTOR, '#i28 > div.vd3tt > div').click()
    
    #para reembalagem tipo papel kraft
    #elemento = nav.find_element(By.CSS_SELECTOR, '#i31 > div.vd3tt > div').click()

    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.o3Dpx > div:nth-child(7) > div > div > div.AgroKb > div > div.aCsJod.oJeWuf > div > div.Xb9hP > input').send_keys(cpf)
    
    time.sleep(5)
    elemento = nav.find_element(By.CSS_SELECTOR, '#mG61Hd > div.RH5hzf.RLS9Fe > div > div.ThHDze > div.DE3NNc.CekdCb > div.lRwqcd > div > span > span').click()
    
    elemento = nav.find_element(By.CSS_SELECTOR,'body > div.Uc2NEf > div:nth-child(2) > div.RH5hzf.RLS9Fe > div > div.c2gzEf > a').click()
    
